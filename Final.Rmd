---
title: "STAT 380 Final Project"
author: "Brian Ellis and James Tondt"
date: "2023-04-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Front Matter
```{r}
rm(list = ls())
#Add libraries as needed
library(tidyverse)
library(knitr)
```

## Call of Duty

![](Call-of-Duty.jpg-d196774.png)

```{r}
# Load datasets
P1 <- read_csv(file = "CODGames_p1_380.csv", show_col_types = FALSE)
kable(head(P1))

P2 <- read_csv("CODGames_p2_380.csv", show_col_types = FALSE)
kable(head(P2))

Maps <- read_csv("CODMaps.csv")
kable(head(Maps))

Modes <- read_csv("CODGameModes.csv")
kable(Modes)
```

```{r}
# Appending Player 2 df to Player 1 df
Players <- P1 %>% 
  rbind(P2)
head(Players)
```

## Task 1 (Data Cleaning and Visualization)

Research Question: Which maps are the most likely to win the map vote? 

We will account for the fact that if there is a tie in voting, Map 1 is chosen by default. Therefore, we will locate whenever there is a tie and disregard the 'Choice' for that particular row. Games which are already underway already have the chosen map listed in choice so we don't care about the map votes for these rows. If we look at the variable 'Choice',
```{r}
sum(is.na(Players$Choice))
```
we see that there are only 2 NA values, so most of our data is present.

```{r}
unique(Players$Choice)
unique(Maps$Name)
```

We can see that there are more unique map names in our Players dataframe as compared with the list of all the map names from our Maps dataframe. This shows us there are misspellings in the map names in the Players dataframe that we must correct before calculating summary statistics.

```{r}
Maps %>% 
  full_join(Players, by = c("Name" = "Choice")) %>% 
  group_by(Name) %>% 
  summarize(Count = n())
```

Using this join query, we can see there are multiple misspellings, added spaces, and a couple NA values. We shall correct for all this before running summaries.

The first thing we can do to correct is remove the added spaces.

```{r}
# remove NAs
Players <- Players %>% 
  na.omit(Choice)
# Remove trailing or leading spaces
Players$Map1 <- trimws(Players$Map1)
Players$Map2 <- trimws(Players$Map2)
Players$Choice <- trimws(Players$Choice)
```


```{r}
# Fixing typos in map names
Players$Map1[Players$Map1 == "APocalypse"] <- "Apocalypse" 
```


